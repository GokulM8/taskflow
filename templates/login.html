{% extends "base.html" %}

{% block title %}Login | TaskFlow{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/auth.css') }}">
{% endblock %}

{% block content %}

<!-- ================= FLASH ERROR MODAL ================= -->
{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div id="errorModal" class="modal-overlay">
      <div class="modal-box">
        <h3>Login Failed</h3>
        {% for category, message in messages %}
          <p>{{ message }}</p>
        {% endfor %}
        <button onclick="closeModal()">OK</button>
      </div>
    </div>
  {% endif %}
{% endwith %}

<div class="login-bg">
    <div class="login-card">

        <h1 class="brand">TaskFlow</h1>

        <h2>Welcome Back</h2>
        <p class="subtitle">Please sign in to your account</p>

        <form method="POST">
            <input type="email" name="email" placeholder="Email" required>
            <input type="password" name="password" placeholder="Password" required>

            <div class="login-options">
                <label>
                    <input type="checkbox">
                    Remember me
                </label>
                <a href="#">Forgot Password?</a>
            </div>

            <button type="submit">Log In</button>
        </form>

        <p class="signup-text">
            Donâ€™t have an account?
            <a href="{{ url_for('register') }}">Sign Up</a>
        </p>

    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    function closeModal() {
        const modal = document.getElementById("errorModal");
        if (modal) modal.style.display = "none";
    }

    // Auto-close popup after 2 seconds
    window.addEventListener("load", () => {
        const modal = document.getElementById("errorModal");
        if (modal) {
            setTimeout(() => {
                modal.style.display = "none";
            }, 2000);
        }
    });
</script>
{% endblock %}
